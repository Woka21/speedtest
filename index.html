<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Speed Test – Check Internet Speed in 3 Seconds</title>
  <meta name="description" content="Accurate, ad-free speed test that runs in your browser. Measure download Mbps and ping in real-time. No app needed.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="canonical" href="https://testinternetspeed.netlify.app/">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>⚡</text></svg>">
  <style>
    :root{--bg:#0d1117;--card:#161b22;--accent:#00ff66;--text:#c9d1d9;--sub:#8b949e}
    *{box-sizing:border-box;margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif}
    body{background:var(--bg);color:var(--text);display:flex;flex-direction:column;min-height:100vh;align-items:center;justify-content:center}
    header{width:100%;padding:1rem 2rem;position:absolute;top:0;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #30363d}
    .logo{font-size:1.5rem;font-weight:700;color:var(--accent)}
    nav .nav-list{list-style:none;display:flex;gap:1.5rem}
    nav a{color:var(--text);text-decoration:none;font-weight:500}nav a:hover{color:var(--accent)}
    main{flex:1;display:flex;align-items:center;justify-content:center;padding:2rem}
    .gauge-card{background:var(--card);border:1px solid #30363d;border-radius:16px;padding:2rem 3rem;text-align:center;max-width:420px;width:90%}
    h1{font-size:1.75rem;margin-bottom:.5rem}
    p.sub{color:var(--sub);margin-bottom:2rem}
    .gauge{width:220px;height:220px;margin:0 auto 2rem;position:relative}
    .gauge-bg{stroke:#30363d;stroke-width:18;fill:none}
    .gauge-fill{stroke:var(--accent);stroke-width:18;stroke-linecap:round;fill:none;transform:rotate(-90deg);transform-origin:center;transition:stroke-dasharray .3s}
    .gauge-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center}
    .gauge-text .value{font-size:3rem;font-weight:700}
    .gauge-text .unit{font-size:1rem;color:var(--sub)}
    button.go{width:100%;padding:1rem;font-size:1.25rem;border:0;border-radius:8px;background:var(--accent);color:var(--bg);cursor:pointer;transition:opacity .2s}button.go:disabled{opacity:.6;cursor:not-allowed}
    footer{margin-top:auto;padding:2rem;font-size:.875rem;color:var(--sub);text-align:center}
    footer a{color:var(--sub);text-decoration:none;margin:0 .5rem}
    @media(max-width:600px){h1{font-size:1.4rem}.gauge{width:180px;height:180px}.gauge-text .value{font-size:2.5rem}}
  </style>

  <!-- invisible structured data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": ["WebSite","QAPage"],
    "name": "Internet Speed Test",
    "url": "https://testinternetspeed.netlify.app/",
    "description": "Free browser-based internet speed test that reports download, upload, ping, IP address and ISP in under 30 seconds.",
    "mainEntity": {
      "@type": "Question",
      "name": "How fast is my internet connection?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Click GO to measure real-time download speed, upload speed, ping latency, your public IP and ISP name."
      }
    }
  }
  </script>
</head>

<body>
  <header>
    <div class="logo">⚡ SpeedTest</div>
    <nav aria-label="Main">
      <ul class="nav-list">
        <li><a href="index.html">Speed Test</a></li>
        <li><a href="about.html">About Us</a></li>
        <li><a href="learn.html">Learn More</a></li>
        <li><a href="faq.html">FAQ</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <div class="gauge-card">
      <h1>Internet Speed Test</h1>
      <p class="sub">Click GO to measure your download speed in seconds</p>

      <div class="gauge">
        <svg width="220" height="220">
          <circle class="gauge-bg" cx="110" cy="110" r="95"></circle>
          <circle class="gauge-fill" cx="110" cy="110" r="95" stroke-dasharray="0 596.9"></circle>
        </svg>
        <div class="gauge-text">
          <div class="value">--</div>
          <div class="unit">Mbps</div>
        </div>
      </div>

      <button class="go" id="goBtn" aria-label="Start speed test">GO</button>

      <!-- NEW technical results block -->
      <section id="tech-results" style="margin-top:2rem;font-family:monospace;background:#161b22;border:1px solid #30363d;border-radius:8px;padding:1rem;text-align:left;color:var(--sub);">
        <h2 style="color:var(--accent);font-size:1.1rem;margin-bottom:.75rem;">Detailed Results</h2>
        <p><strong>Download:</strong>  <span id="down">--</span> Mbps</p>
        <p><strong>Upload:</strong>    <span id="up">--</span> Mbps</p>
        <p><strong>Ping:</strong>      <span id="ping">--</span> ms</p>
        <p><strong>IP Address:</strong> <span id="ip">--</span></p>
        <p><strong>ISP / Carrier:</strong> <span id="isp">--</span></p>
        <small style="display:block;margin-top:.5rem;">Values update automatically when the test ends.</small>
      </section>
    </div>
  </main>

  <footer>
    <a href="/about">About</a>
    <a href="/learn.html">learn</a>
    <a href="/faq">FAQ</a>
  </footer>

  <script>
    const goBtn   = document.getElementById('goBtn');
    const valueEl = document.querySelector('.gauge-text .value');
    const fillEl  = document.querySelector('.gauge-fill');
    const downEl  = document.getElementById('down');
    const upEl    = document.getElementById('up');
    const pingEl  = document.getElementById('ping');
    const ipEl    = document.getElementById('ip');
    const ispEl   = document.getElementById('isp');
    const CF_DOWN = 'https://speed.cloudflare.com/__down?bytes=100000000';
    const CF_UP   = 'https://speed.cloudflare.com/__up';
    const CF_LAT  = 'https://speed.cloudflare.com/__latency';

    const circumference = 2 * Math.PI * 95;

    async function runTest() {
      goBtn.disabled = true;
      valueEl.textContent = '0';
      fillEl.style.strokeDasharray = `0 ${circumference}`;
      const start = performance.now();

      // ----- download sample -----
      const dlResp = await fetch(CF_DOWN);
      const reader = dlResp.body.getReader();
      let bytes = 0;
      const timer = setInterval(() => { if ((performance.now() - start) > 3000) { reader.cancel(); clearInterval(timer); } }, 100);
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;
        bytes += value.length;
      }
      clearInterval(timer);
      const sec   = (performance.now() - start) / 1000;
      const downMbps = (bytes * 8) / (sec * 1e6);

      // ----- upload sample (10 MB) -----
      const uplData = new Blob([new Uint8Array(10 * 1024 * 1024)]);
      const upStart = performance.now();
      await fetch(CF_UP, { method: 'POST', body: uplData });
      const upSec   = (performance.now() - upStart) / 1000;
      const upMbps  = (80) / upSec;  // 80 Mbit

      // ----- latency (ping) -----
      const lat0 = performance.now();
      await fetch(CF_LAT);
      const pingMs = (performance.now() - lat0);

      // ----- IP + ISP -----
      const ipInfo = await (await fetch('https://ipapi.co/json/')).json();
      ipEl.textContent  = ipInfo.ip;
      ispEl.textContent = ipInfo.org || 'Unknown';

      // ----- update UI -----
      const pct = Math.min(downMbps / 200, 1);
      fillEl.style.strokeDasharray = `${pct * circumference} ${circumference}`;
      valueEl.textContent = downMbps.toFixed(1);
      downEl.textContent = downMbps.toFixed(1);
      upEl.textContent   = upMbps.toFixed(1);
      pingEl.textContent = pingMs.toFixed(0);
      goBtn.disabled = false;
    }
    goBtn.addEventListener('click', runTest);
  </script>
</body>
</html>
